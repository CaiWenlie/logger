export default `!function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=0)}([function(t,n,e){"use strict";function r(){for(var t=[],n=0;n<36;n++)t[n]="0123456789abcdef".substr(Math.floor(16*Math.random()),1);return t[14]="4",t[19]="0123456789abcdef".substr(3&t[19]|8,1),t[8]="-",t[13]="-",t[18]="-",t[23]="-",t.join("")}function o(t){return t<10?"0"+t:t}function i(t){var n,e=void 0!==t.payload?" payload="+(("object"==typeof(n=t.payload)?JSON.stringify(n):n.toString())+";"):"",r=t.network?" network="+t.network+";":"";return"["+t.time+"]:["+t.type+"] msg="+t.msg+";"+e+" uid="+t.uid+"; traceid="+t.traceid+"; logid="+t.logid+"; duration="+t.duration+"; "+r+" url="+t.url+"; ua="+t.ua+";"}e.r(n);var u,a=function(){function t(n){var e=n.id,r=n.useConsole,o=n.maxRecords;this.data={uid:"",traceid:"",network:"",url:"",ua:""},this.config={useConsole:!0,maxRecords:-1},this.injectConfig({useConsole:r,maxRecords:o}),this.name=t.DEFAULT_DB_NAME_PREFIX+"_"+e,this.refreshTraceId()}return t.prototype.refreshTraceId=function(){this.data.traceid=r(),this.refreshDurationStart()},t.prototype.refreshDurationStart=function(){this.durationStart=Date.now()},t.prototype.injectBaseInfo=function(t){Object.assign(this.data,t)},t.prototype.injectConfig=function(t){Object.assign(this.config,t)},t.prototype.appendBaseInfo=function(t){var n=new Date,e=n.getTime(),u=function(t,n){void 0===n&&(n=":");var e=t.getFullYear()+"-"+o(t.getMonth()+1)+"-"+o(t.getDate()),r=t.getMilliseconds(),i=r<100?"0"+o(r):r;return e+" "+o(t.getHours())+n+o(t.getMinutes())+n+o(t.getSeconds())+n+i}(n),a=e-this.durationStart,c=Object.assign(t,this.data,{timestamp:e,time:u,logid:r(),duration:a});if(this.config.useConsole){var s=i(c);(console[c.type]||console.log)(s)}return c},t.DEFAULT_DB_NAME_PREFIX="tc_logger",t}(),c=(u=function(t,n){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(t,n)},function(t,n){function e(){this.constructor=t}u(t,n),t.prototype=null===n?Object.create(n):(e.prototype=n.prototype,new e)}),s=function(t){function n(n){var e=t.call(this,n)||this;return e.baseInfo=new a(n),e}return c(n,t),Object.defineProperty(n.prototype,"name",{get:function(){return this.baseInfo.name},enumerable:!1,configurable:!0}),n.prototype.injectBaseInfo=function(t){this.baseInfo.injectBaseInfo(t)},n.prototype.refreshTraceId=function(){this.baseInfo.refreshTraceId()},n.prototype.refreshDurationStart=function(){this.baseInfo.refreshDurationStart()},n}((function(t){}));function f(t,n){if("function"==typeof n)return n(t);if("object"==typeof t){if("Object"===t.constructor.name){if(n instanceof Array){for(var e=0;e<n.length;e++){if(f(t,n[e]))return!0}return!1}for(var r in n){if(!f(t[r],n[r]))return!1}return!0}return t.toString()===n.toString()}return n instanceof RegExp?n.test(t):t===n}var l={transFunc:function(t){return"function"==typeof t?"/*fn*/"+t.toString():t},transBack:function(t){return"string"==typeof t?new Function("return ("+t+")")():t},isFuncString:function(t){return 0===t.indexOf("/*fn*/")}},d=function(){var t=function(n,e){return(t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var e in n)n.hasOwnProperty(e)&&(t[e]=n[e])})(n,e)};return function(n,e){function r(){this.constructor=n}t(n,e),n.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}(),p=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function u(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,a)}c((r=r.apply(t,n||[])).next())}))},h=function(t,n){var e,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=n.call(t,u)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}},y={};var b=function(t){function n(n){void 0===n&&(n="default");var e,r=t.call(this,{id:n,useConsole:!0,maxRecords:0})||this;return r.STORE_NAME="records",r.loadCallbacks=[],y[r.name]?y[r.name]:(r.db||r._initDB(),y[r.name]=r,r.msgMap=(e=r,{add:function(t){return e.add(t)},injectConfig:function(t){return e.baseInfo.injectConfig(t)},closeDB:function(){return e.close()},destory:function(){return e.destory()},refreshTraceId:function(){return e.refreshTraceId()},injectBaseInfo:function(t){return e.baseInfo.injectBaseInfo(t)},get:function(t){return e.get(t)},getAll:function(){return e.getAll()},refreshDurationStart:function(){return e.refreshDurationStart()},filter:function(t){return e.filter(t)},download:function(t){return e.download(t)}}),r)}return d(n,t),n.prototype.add=function(t){var n=this;return new Promise((function(e){return p(n,void 0,void 0,(function(){var n,r,o=this;return h(this,(function(i){switch(i.label){case 0:return t?(n=this.baseInfo.appendBaseInfo(t),this.db?[3,1]:(this.loadCallbacks.push((function(){return p(o,void 0,void 0,(function(){var t;return h(this,(function(r){switch(r.label){case 0:return t=e,[4,this._addDBData(n)];case 1:return t.apply(void 0,[r.sent()]),[2]}}))}))})),[3,3])):(console.warn("add: data is required"),[2,null]);case 1:return r=e,[4,this._addDBData(n)];case 2:r.apply(void 0,[i.sent()]),i.label=3;case 3:return[2]}}))}))}))},n.prototype._addDBData=function(t){var n=this;return new Promise((function(e){var r=n._getStore("readwrite").add(t);r.onsuccess=function(){e(t)},r.onerror=function(t){console.log("数据写入失败",t),e(null)}}))},n.prototype._getStore=function(t){return void 0===t&&(t="readonly"),this.db.transaction([this.STORE_NAME],t).objectStore(this.STORE_NAME)},n.prototype.close=function(){this.db.close(),this.db=void 0},n.prototype.destory=function(){this.close(),globalThis.indexedDB.deleteDatabase(this.baseInfo.name),delete y[this.name]},n.prototype.get=function(t){var n=this;return new Promise((function(e){var r=n._getStore("readonly").get(t);r.onerror=function(){console.log("查询失败"),e(null)},r.onsuccess=function(){r.result?e(r.result):(console.log("未查询到记录"),e(null))}}))},n.prototype.getAll=function(){var t=this;return new Promise((function(n){var e=[];t._cursorBase({onvalue:function(t){e.push(t)},onend:function(){n(e)},onerror:function(){n([])}})}))},n.prototype.download=function(t){var n=this;return t=l.transBack(t),new Promise((function(e){var r="";n._cursorBase({onvalue:function(n){f(n,t)&&(r+=i(n)+"\\n")},onend:function(){e(r)},onerror:function(){e("")}})}))},n.prototype.filter=function(t){var n=this;return t=l.transBack(t),new Promise((function(e){var r=[];n._cursorBase({onvalue:function(n){f(n,t)&&r.push(n)},onend:function(){e(r)},onerror:function(){e([])}})}))},n.prototype._cursorBase=function(t){var n=t.onend,e=t.onvalue,r=t.onerror,o=this._getStore().openCursor();o.onsuccess=function(t){var r=(null==t?void 0:t.target).result;r?(e(r.value),r.continue()):n()},o.onerror=function(){console.error("查询失败"),r()}},n.prototype._initDB=function(){var t=this,n=globalThis.indexedDB.open(this.name,1);n.onerror=function(t){console.error("数据库打开报错",t)},n.onsuccess=function(){t.db=n.result,t.loadCallbacks.forEach((function(t){return t()}))},n.onupgradeneeded=function(n){var e,r=null===(e=n.target)||void 0===e?void 0:e.result;t._checkCreateStore(r,t.STORE_NAME)}},n.prototype._checkCreateStore=function(t,n){t.objectStoreNames.contains(n)||t.createObjectStore(n,{keyPath:"logid"})},n}(s),v=function(t,n,e,r){return new(e||(e=Promise))((function(o,i){function u(t){try{c(r.next(t))}catch(t){i(t)}}function a(t){try{c(r.throw(t))}catch(t){i(t)}}function c(t){var n;t.done?o(t.value):(n=t.value,n instanceof e?n:new e((function(t){t(n)}))).then(u,a)}c((r=r.apply(t,n||[])).next())}))},g=function(t,n){var e,r,o,i,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function a(i){return function(a){return function(i){if(e)throw new TypeError("Generator is already executing.");for(;u;)try{if(e=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return u.label++,{value:i[1],done:!1};case 5:u.label++,r=i[1],i=[0];continue;case 7:i=u.ops.pop(),u.trys.pop();continue;default:if(!(o=u.trys,(o=o.length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){u=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){u.label=i[1];break}if(6===i[0]&&u.label<o[1]){u.label=o[1],o=i;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(i);break}o[2]&&u.ops.pop(),u.trys.pop();continue}i=n.call(t,u)}catch(t){i=[6,t],r=0}finally{e=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,a])}}};globalThis.addEventListener("message",(function(t){return v(this,void 0,void 0,(function(){var n,e,r,o,i,u,a;return g(this,(function(c){switch(c.label){case 0:return n=t.data,e=n.msgid,r=n.type,o=n.data,i=n.id,u=new b(i),(a=u.msgMap[r](o))instanceof Promise?[4,a]:[3,2];case 1:a=c.sent(),c.label=2;case 2:return globalThis.postMessage({msgid:e,id:i,type:r,result:a}),[2]}}))}))}),!1)}]);`;